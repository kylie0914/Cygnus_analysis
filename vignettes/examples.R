## --------------------------------------------------------------------------------------------------------------------
library(Cygnus)
library(viridis)
library(plotly)

## --------------------------------------------------------------------------------------------------------------------
data.path <- "../inst/extdata/all_cells.csv" 
# cyg <- CreateCygnus(data.path) # this starts the interactive app

cyg <- CreateCygnus(data.path,
                    markers_col = c("PanEV", "EpCAM", "MET",
                                    "SDC1", "EGFR", "ADAM10",
                                    "CTSH", "PDL1", "HER2" ),
                    meta_col = "celltype")

cyg

## --------------------------------------------------------------------------------------------------------------------
cyg@ev_meta[['type']] <- "cell_line"

## --------------------------------------------------------------------------------------------------------------------
plotDistribution(cyg)

## --------------------------------------------------------------------------------------------------------------------
cyg <- scaleExpressionMatrix(cyg)
plotDistribution(cyg, matrix = "scaled_exp_matrix")

## --------------------------------------------------------------------------------------------------------------------
cyg <- normalizeByPanEV(cyg, "PanEV") 
plotDistribution(cyg, matrix = "normalized_exp_mat")

## --------------------------------------------------------------------------------------------------------------------
# NEED TO BE UPDATED

## --------------------------------------------------------------------------------------------------------------------
cyg <- createBinaryMatrix(cyg, thresholds = 1000)
plotDistribution(cyg, matrix = "binary_exp_matrix")

## --------------------------------------------------------------------------------------------------------------------
plotAvgHeatmap(cyg, "celltype", scale = "row")

## --------------------------------------------------------------------------------------------------------------------
# co localization (show venn and upset)

## --------------------------------------------------------------------------------------------------------------------
# customizing upset

## --------------------------------------------------------------------------------------------------------------------
# pairwise .....

## --------------------------------------------------------------------------------------------------------------------
# devience

## --------------------------------------------------------------------------------------------------------------------
# upset plot

## --------------------------------------------------------------------------------------------------------------------
cyg <- markRelevantMarkers(cyg, c("EpCAM", "MET",
                               "SDC1", "EGFR", "ADAM10",
                               "CTSH", "PDL1", "HER2")) 


## --------------------------------------------------------------------------------------------------------------------
cyg <- runPCA(cyg, matrix_name = "Raw_Score") 
plotPCA(cyg, color_by = "celltype")

## --------------------------------------------------------------------------------------------------------------------


## --------------------------------------------------------------------------------------------------------------------
plotElbowPlot(cyg)

