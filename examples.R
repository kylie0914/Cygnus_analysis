## --------------------------------------------------------------------------------------------------------------------
library(Cygnus)
library(viridis)
library(plotly)


## --------------------------------------------------------------------------------------------------------------------
data.path <- "../inst/extdata/all_cells.csv" 
# cyg <- CreateCygnus(data.path) # this starts the interactive app

cyg <- CreateCygnus(data.path,
                    markers_col = c("PanEV", "EpCAM", "MET",
                                    "SDC1", "EGFR", "ADAM10",
                                    "CTSH", "PDL1", "HER2" ),
                    meta_col = "celltype")

cyg


## --------------------------------------------------------------------------------------------------------------------
cyg@ev_meta[['type']] <- "cell_line"


## --------------------------------------------------------------------------------------------------------------------
plotDistribution(cyg)


## --------------------------------------------------------------------------------------------------------------------
cyg <- scaleExpressionMatrix(cyg)
plotDistribution(cyg, matrix = "scaled_exp_matrix")


## --------------------------------------------------------------------------------------------------------------------
cyg <- normalizeByPanEV(cyg, "PanEV") 
plotDistribution(cyg, matrix = "normalized_exp_mat")


## --------------------------------------------------------------------------------------------------------------------
# NEED TO BE UPDATED


## --------------------------------------------------------------------------------------------------------------------
cyg <- createBinaryMatrix(cyg, thresholds = 1000)
plotDistribution(cyg, matrix = "binary_exp_matrix")


## --------------------------------------------------------------------------------------------------------------------
plotAvgHeatmap(cyg, "celltype", scale = "row")


## --------------------------------------------------------------------------------------------------------------------
# co localization (show venn and upset)


## --------------------------------------------------------------------------------------------------------------------
# customizing upset


## --------------------------------------------------------------------------------------------------------------------
# pairwise .....


## --------------------------------------------------------------------------------------------------------------------
# devience


## --------------------------------------------------------------------------------------------------------------------
# upset plot


## --------------------------------------------------------------------------------------------------------------------
cyg <- markRelevantMarkers(cyg, c("EpCAM", "MET",
                               "SDC1", "EGFR", "ADAM10",
                               "CTSH", "PDL1", "HER2")) 



## --------------------------------------------------------------------------------------------------------------------
cyg <- runPCA(cyg, matrix_name = "Raw_Score") 
plotPCA(cyg, color_by = "celltype")

## --------------------------------------------------------------------------------------------------------------------



## --------------------------------------------------------------------------------------------------------------------
plotElbowPlot(cyg)

## --------------------------------------------------------------------------------------------------------------------
cyg <- runTSNE(cyg)
#plotTSNE(cyg, color_by = "celltype", marker_size = 10, plot_3d = F, matrix_name = "Raw_Score")


## --------------------------------------------------------------------------------------------------------------------
#plotTSNE(cyg, color_by = "HER2", marker_size = 10, matrix_name = 'scaled_exp_matrix')

## --------------------------------------------------------------------------------------------------------------------
#plotTSNE(cyg, color_by = "HER2", marker_size = 10, matrix_name = 'normalized_exp_mat')

## --------------------------------------------------------------------------------------------------------------------
#plotTSNE(cyg, color_by = "HER2", marker_size = 10, matrix_name = 'binary_exp_matrix')


## --------------------------------------------------------------------------------------------------------------------
#cyg <- runUMAP(cyg)


## --------------------------------------------------------------------------------------------------------------------
#plotUMAP(cyg, color_by = "celltype", marker_size = 10)

## --------------------------------------------------------------------------------------------------------------------
plotUpSet(cyg, markers = c("EpCAM", "MET",
                               "SDC1", "EGFR", "ADAM10",
                               "CTSH", "PDL1", "HER2"))

## --------------------------------------------------------------------------------------------------------------------
cyg <- ClusterCygnus(cyg, n_clusters = 3)
#plotTSNE(cyg, color_by = 'k_means_clusters', marker_size = 10)

## --------------------------------------------------------------------------------------------------------------------
#plotTSNE(cyg, color_by = 'celltype', marker_size = 10)

